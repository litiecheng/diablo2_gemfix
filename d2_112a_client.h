PATCH_BEGIN("D2Client.dll", 0x8a620d68)

PATCH_VAR(0xD1D4, D2Lang_10005_112a)

/* GemFix - 512 byte buffer */
#define GEM_BUF_SIZE 0x400
PATCH(0x8A3C2, LE_BYTES(GEM_BUF_SIZE + 0x4))
PATCH(0x8A3CB, LE_BYTES(GEM_BUF_SIZE + 0x10))
PATCH(0x8A3DA, LE_BYTES(GEM_BUF_SIZE/2))
PATCH(0x8A75C, LE_BYTES(GEM_BUF_SIZE + 0x4))
PATCH_ORIG(0x8A3C2, 0x04, 0x02, 0x00, 0x00)
PATCH_ORIG(0x8A3CB, 0x10, 0x02, 0x00, 0x00)
PATCH_ORIG(0x8A3DA, 0x00, 0x01, 0x00, 0x00)
PATCH_ORIG(0x8A75C, 0x04, 0x02, 0x00, 0x00)

PATCH(0xAD2F7, LE_BYTES(GEM_BUF_SIZE))
PATCH_ORIG(0xAD2F7, 0x00, 0x02, 0x00, 0x00)

/* GemFix - Split lines */
PATCH(0x89D0E, LE_BYTES(0xF9E))
PATCH_ORIG(0x89D0E, 0x0C, 0x0F, 0x00, 0x00)

PATCH(0x8A215, 0xE8 /* call .... */)
PATCH_REL(0x8A216, GemFixSplitLines1_1_112a)
PATCH(0x8A21A, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90)
PATCH_ORIG(0x8A215, 0x5E, 0x5D, 0x5B, 0x81, 0xC4, 0x08, 0x08, 0x00, 0x00, 0xC2, 0x0C, 0x00)

PATCH(0x8A22C, LE_BYTES(0xF9E))
PATCH_ORIG(0x8A22C, 0x0C, 0x0F, 0x00, 0x00)

PATCH(0x886DC, 0xE8)
PATCH_REL(0x886DD, GemFixSplitLines1_2_112a)
PATCH_ORIG(0x886DC, 0xBB, 0x01, 0x00, 0x00, 0x00)

PATCH_REL(0x8A74D, GemFixSplitLines1_3_112a)
PATCH_ORIG(0x8A74D, 0x83, 0x2A, 0xF8, 0xFF)

PATCH_REL(0xAD306, GemFixSplitLines2_1_112a)
PATCH_ORIG(0xAD306, 0xCA, 0xFE, 0xF5, 0xFF)

PATCH_END()
